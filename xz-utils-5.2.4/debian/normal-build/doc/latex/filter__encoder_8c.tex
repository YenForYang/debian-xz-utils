\section{liblzma/common/filter\+\_\+encoder.c File Reference}
\label{filter__encoder_8c}\index{liblzma/common/filter\+\_\+encoder.\+c@{liblzma/common/filter\+\_\+encoder.\+c}}


Filter ID mapping to filter-\/specific functions.  


{\ttfamily \#include \char`\"{}filter\+\_\+encoder.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}filter\+\_\+common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lzma\+\_\+encoder.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lzma2\+\_\+encoder.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}simple\+\_\+encoder.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}delta\+\_\+encoder.\+h\char`\"{}}\newline
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ lzma\+\_\+filter\+\_\+encoder}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\label{filter__encoder_8c_ad5dc226c8305a5fd6b0e0f80ab72b35a}} 
static const \textbf{ lzma\+\_\+filter\+\_\+encoder} $\ast$ {\bfseries encoder\+\_\+find} (\textbf{ lzma\+\_\+vli} \textbf{ id})
\item 
\textbf{ lzma\+\_\+bool} \textbf{ lzma\+\_\+filter\+\_\+encoder\+\_\+is\+\_\+supported} (\textbf{ lzma\+\_\+vli} \textbf{ id})
\begin{DoxyCompactList}\small\item\em Test if the given Filter ID is supported for encoding. \end{DoxyCompactList}\item 
\textbf{ lzma\+\_\+ret} \textbf{ lzma\+\_\+filters\+\_\+update} (\textbf{ lzma\+\_\+stream} $\ast$\textbf{ strm}, const \textbf{ lzma\+\_\+filter} $\ast$\textbf{ filters})
\begin{DoxyCompactList}\small\item\em Update the filter chain in the encoder. \end{DoxyCompactList}\item 
\mbox{\label{filter__encoder_8c_af71b9ac685ec70bb2b905993499d2b80}} 
\textbf{ lzma\+\_\+ret} {\bfseries lzma\+\_\+raw\+\_\+encoder\+\_\+init} (\textbf{ lzma\+\_\+next\+\_\+coder} $\ast$next, const \textbf{ lzma\+\_\+allocator} $\ast$allocator, const \textbf{ lzma\+\_\+filter} $\ast$options)
\item 
\textbf{ lzma\+\_\+ret} \textbf{ lzma\+\_\+raw\+\_\+encoder} (\textbf{ lzma\+\_\+stream} $\ast$\textbf{ strm}, const \textbf{ lzma\+\_\+filter} $\ast$options)
\begin{DoxyCompactList}\small\item\em Initialize raw encoder. \end{DoxyCompactList}\item 
uint64\+\_\+t \textbf{ lzma\+\_\+raw\+\_\+encoder\+\_\+memusage} (const \textbf{ lzma\+\_\+filter} $\ast$\textbf{ filters})
\begin{DoxyCompactList}\small\item\em Calculate approximate memory requirements for raw encoder. \end{DoxyCompactList}\item 
\mbox{\label{filter__encoder_8c_aaedc859d12a6fc09ea6d041faa48d7c1}} 
uint64\+\_\+t {\bfseries lzma\+\_\+mt\+\_\+block\+\_\+size} (const \textbf{ lzma\+\_\+filter} $\ast$\textbf{ filters})
\item 
\textbf{ lzma\+\_\+ret} \textbf{ lzma\+\_\+properties\+\_\+size} (uint32\+\_\+t $\ast$size, const \textbf{ lzma\+\_\+filter} $\ast$filter)
\begin{DoxyCompactList}\small\item\em Get the size of the Filter Properties field. \end{DoxyCompactList}\item 
\textbf{ lzma\+\_\+ret} \textbf{ lzma\+\_\+properties\+\_\+encode} (const \textbf{ lzma\+\_\+filter} $\ast$filter, uint8\+\_\+t $\ast$props)
\begin{DoxyCompactList}\small\item\em Encode the Filter Properties field. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\label{filter__encoder_8c_a0a6f06ddf54c46fdee728b762e606636}} 
static const \textbf{ lzma\+\_\+filter\+\_\+encoder} {\bfseries encoders} [$\,$]
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Filter ID mapping to filter-\/specific functions. 



\subsection{Function Documentation}
\mbox{\label{filter__encoder_8c_a1600cc95c59adc4ff5fa196652142a31}} 
\index{filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}!lzma\+\_\+filter\+\_\+encoder\+\_\+is\+\_\+supported@{lzma\+\_\+filter\+\_\+encoder\+\_\+is\+\_\+supported}}
\index{lzma\+\_\+filter\+\_\+encoder\+\_\+is\+\_\+supported@{lzma\+\_\+filter\+\_\+encoder\+\_\+is\+\_\+supported}!filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}}
\subsubsection{lzma\+\_\+filter\+\_\+encoder\+\_\+is\+\_\+supported()}
{\footnotesize\ttfamily \textbf{ lzma\+\_\+bool} lzma\+\_\+filter\+\_\+encoder\+\_\+is\+\_\+supported (\begin{DoxyParamCaption}\item[{\textbf{ lzma\+\_\+vli}}]{id }\end{DoxyParamCaption}) const}



Test if the given Filter ID is supported for encoding. 

Return true if the give Filter ID is supported for encoding by this liblzma build. Otherwise false is returned.

There is no way to list which filters are available in this particular liblzma version and build. It would be useless, because the application couldn\textquotesingle{}t know what kind of options the filter would need. \mbox{\label{filter__encoder_8c_adcde5a9917d1ca033f6c1cc35c9be4fc}} 
\index{filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}!lzma\+\_\+filters\+\_\+update@{lzma\+\_\+filters\+\_\+update}}
\index{lzma\+\_\+filters\+\_\+update@{lzma\+\_\+filters\+\_\+update}!filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}}
\subsubsection{lzma\+\_\+filters\+\_\+update()}
{\footnotesize\ttfamily \textbf{ lzma\+\_\+ret} lzma\+\_\+filters\+\_\+update (\begin{DoxyParamCaption}\item[{\textbf{ lzma\+\_\+stream} $\ast$}]{strm,  }\item[{const \textbf{ lzma\+\_\+filter} $\ast$}]{filters }\end{DoxyParamCaption})}



Update the filter chain in the encoder. 

This function is for advanced users only. This function has two slightly different purposes\+:


\begin{DoxyItemize}
\item After L\+Z\+M\+A\+\_\+\+F\+U\+L\+L\+\_\+\+F\+L\+U\+SH when using Stream encoder\+: Set a new filter chain, which will be used starting from the next Block.
\item After L\+Z\+M\+A\+\_\+\+S\+Y\+N\+C\+\_\+\+F\+L\+U\+SH using Raw, Block, or Stream encoder\+: Change the filter-\/specific options in the middle of encoding. The actual filters in the chain (Filter I\+Ds) cannot be changed. In the future, it might become possible to change the filter options without using L\+Z\+M\+A\+\_\+\+S\+Y\+N\+C\+\_\+\+F\+L\+U\+SH.
\end{DoxyItemize}

While rarely useful, this function may be called also when no data has been compressed yet. In that case, this function will behave as if L\+Z\+M\+A\+\_\+\+F\+U\+L\+L\+\_\+\+F\+L\+U\+SH (Stream encoder) or L\+Z\+M\+A\+\_\+\+S\+Y\+N\+C\+\_\+\+F\+L\+U\+SH (Raw or Block encoder) had been used right before calling this function.

\begin{DoxyReturn}{Returns}
-\/ L\+Z\+M\+A\+\_\+\+OK
\begin{DoxyItemize}
\item L\+Z\+M\+A\+\_\+\+M\+E\+M\+\_\+\+E\+R\+R\+OR
\item L\+Z\+M\+A\+\_\+\+M\+E\+M\+L\+I\+M\+I\+T\+\_\+\+E\+R\+R\+OR
\item L\+Z\+M\+A\+\_\+\+O\+P\+T\+I\+O\+N\+S\+\_\+\+E\+R\+R\+OR
\item L\+Z\+M\+A\+\_\+\+P\+R\+O\+G\+\_\+\+E\+R\+R\+OR 
\end{DoxyItemize}
\end{DoxyReturn}


References filters, lzma\+\_\+stream\+::internal, L\+Z\+M\+A\+\_\+\+P\+R\+O\+G\+\_\+\+E\+R\+R\+OR, lzma\+\_\+raw\+\_\+encoder\+\_\+memusage(), lzma\+\_\+internal\+\_\+s\+::next, strm, and lzma\+\_\+next\+\_\+coder\+\_\+s\+::update.

\mbox{\label{filter__encoder_8c_aed21808fcea4df30f742c5369627f731}} 
\index{filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}!lzma\+\_\+raw\+\_\+encoder@{lzma\+\_\+raw\+\_\+encoder}}
\index{lzma\+\_\+raw\+\_\+encoder@{lzma\+\_\+raw\+\_\+encoder}!filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}}
\subsubsection{lzma\+\_\+raw\+\_\+encoder()}
{\footnotesize\ttfamily \textbf{ lzma\+\_\+ret} lzma\+\_\+raw\+\_\+encoder (\begin{DoxyParamCaption}\item[{\textbf{ lzma\+\_\+stream} $\ast$}]{strm,  }\item[{const \textbf{ lzma\+\_\+filter} $\ast$}]{filters }\end{DoxyParamCaption})}



Initialize raw encoder. 

This function may be useful when implementing custom file formats.


\begin{DoxyParams}{Parameters}
{\em strm} & Pointer to properly prepared \doxyref{lzma\+\_\+stream}{p.}{structlzma__stream} \\
\hline
{\em filters} & Array of \doxyref{lzma\+\_\+filter}{p.}{structlzma__filter} structures. The end of the array must be marked with .id = L\+Z\+M\+A\+\_\+\+V\+L\+I\+\_\+\+U\+N\+K\+N\+O\+WN.\\
\hline
\end{DoxyParams}
The `action\textquotesingle{} with \doxyref{lzma\+\_\+code()}{p.}{base_8h_a28cc09bc422d5ba1e0187c9f2af5d957} can be L\+Z\+M\+A\+\_\+\+R\+UN, L\+Z\+M\+A\+\_\+\+S\+Y\+N\+C\+\_\+\+F\+L\+U\+SH (if the filter chain supports it), or L\+Z\+M\+A\+\_\+\+F\+I\+N\+I\+SH.

\begin{DoxyReturn}{Returns}
-\/ L\+Z\+M\+A\+\_\+\+OK
\begin{DoxyItemize}
\item L\+Z\+M\+A\+\_\+\+M\+E\+M\+\_\+\+E\+R\+R\+OR
\item L\+Z\+M\+A\+\_\+\+O\+P\+T\+I\+O\+N\+S\+\_\+\+E\+R\+R\+OR
\item L\+Z\+M\+A\+\_\+\+P\+R\+O\+G\+\_\+\+E\+R\+R\+OR 
\end{DoxyItemize}
\end{DoxyReturn}


References lzma\+\_\+next\+\_\+strm\+\_\+init.

\mbox{\label{filter__encoder_8c_a6c882f0353d7fe74157b51f0776093ae}} 
\index{filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}!lzma\+\_\+raw\+\_\+encoder\+\_\+memusage@{lzma\+\_\+raw\+\_\+encoder\+\_\+memusage}}
\index{lzma\+\_\+raw\+\_\+encoder\+\_\+memusage@{lzma\+\_\+raw\+\_\+encoder\+\_\+memusage}!filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}}
\subsubsection{lzma\+\_\+raw\+\_\+encoder\+\_\+memusage()}
{\footnotesize\ttfamily uint64\+\_\+t lzma\+\_\+raw\+\_\+encoder\+\_\+memusage (\begin{DoxyParamCaption}\item[{const \textbf{ lzma\+\_\+filter} $\ast$}]{filters }\end{DoxyParamCaption})}



Calculate approximate memory requirements for raw encoder. 

This function can be used to calculate the memory requirements for Block and Stream encoders too because Block and Stream encoders don\textquotesingle{}t need significantly more memory than raw encoder.


\begin{DoxyParams}{Parameters}
{\em filters} & Array of filters terminated with .id == L\+Z\+M\+A\+\_\+\+V\+L\+I\+\_\+\+U\+N\+K\+N\+O\+WN.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Number of bytes of memory required for the given filter chain when encoding. If an error occurs, for example due to unsupported filter chain, U\+I\+N\+T64\+\_\+\+M\+AX is returned. 
\end{DoxyReturn}


Referenced by lzma\+\_\+filters\+\_\+update().

\mbox{\label{filter__encoder_8c_a7ea8fcfdb19312ff323a78fb6d5ce908}} 
\index{filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}!lzma\+\_\+properties\+\_\+size@{lzma\+\_\+properties\+\_\+size}}
\index{lzma\+\_\+properties\+\_\+size@{lzma\+\_\+properties\+\_\+size}!filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}}
\subsubsection{lzma\+\_\+properties\+\_\+size()}
{\footnotesize\ttfamily \textbf{ lzma\+\_\+ret} lzma\+\_\+properties\+\_\+size (\begin{DoxyParamCaption}\item[{uint32\+\_\+t $\ast$}]{size,  }\item[{const \textbf{ lzma\+\_\+filter} $\ast$}]{filter }\end{DoxyParamCaption})}



Get the size of the Filter Properties field. 

This function may be useful when implementing custom file formats using the raw encoder and decoder.


\begin{DoxyParams}{Parameters}
{\em size} & Pointer to uint32\+\_\+t to hold the size of the properties \\
\hline
{\em filter} & Filter ID and options (the size of the properties may vary depending on the options)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/ L\+Z\+M\+A\+\_\+\+OK
\begin{DoxyItemize}
\item L\+Z\+M\+A\+\_\+\+O\+P\+T\+I\+O\+N\+S\+\_\+\+E\+R\+R\+OR
\item L\+Z\+M\+A\+\_\+\+P\+R\+O\+G\+\_\+\+E\+R\+R\+OR
\end{DoxyItemize}
\end{DoxyReturn}
\begin{DoxyNote}{Note}
This function validates the Filter ID, but does not necessarily validate the options. Thus, it is possible that this returns L\+Z\+M\+A\+\_\+\+OK while the following call to \doxyref{lzma\+\_\+properties\+\_\+encode()}{p.}{filter_8h_a8e00887086df5a44084ac22e48415de3} returns L\+Z\+M\+A\+\_\+\+O\+P\+T\+I\+O\+N\+S\+\_\+\+E\+R\+R\+OR. 
\end{DoxyNote}


Referenced by lzma\+\_\+filter\+\_\+flags\+\_\+encode(), and lzma\+\_\+filter\+\_\+flags\+\_\+size().

\mbox{\label{filter__encoder_8c_a311b1198ed1c047fefc31071adb5600b}} 
\index{filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}!lzma\+\_\+properties\+\_\+encode@{lzma\+\_\+properties\+\_\+encode}}
\index{lzma\+\_\+properties\+\_\+encode@{lzma\+\_\+properties\+\_\+encode}!filter\+\_\+encoder.\+c@{filter\+\_\+encoder.\+c}}
\subsubsection{lzma\+\_\+properties\+\_\+encode()}
{\footnotesize\ttfamily \textbf{ lzma\+\_\+ret} lzma\+\_\+properties\+\_\+encode (\begin{DoxyParamCaption}\item[{const \textbf{ lzma\+\_\+filter} $\ast$}]{filter,  }\item[{uint8\+\_\+t $\ast$}]{props }\end{DoxyParamCaption})}



Encode the Filter Properties field. 


\begin{DoxyParams}{Parameters}
{\em filter} & Filter ID and options \\
\hline
{\em props} & Buffer to hold the encoded options. The size of buffer must have been already determined with \doxyref{lzma\+\_\+properties\+\_\+size()}{p.}{filter_8h_aee038818cf7bbe044c3f7a7c86998c1b}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/ L\+Z\+M\+A\+\_\+\+OK
\begin{DoxyItemize}
\item L\+Z\+M\+A\+\_\+\+O\+P\+T\+I\+O\+N\+S\+\_\+\+E\+R\+R\+OR
\item L\+Z\+M\+A\+\_\+\+P\+R\+O\+G\+\_\+\+E\+R\+R\+OR
\end{DoxyItemize}
\end{DoxyReturn}
\begin{DoxyNote}{Note}
Even this function won\textquotesingle{}t validate more options than actually necessary. Thus, it is possible that encoding the properties succeeds but using the same options to initialize the encoder will fail.

If \doxyref{lzma\+\_\+properties\+\_\+size()}{p.}{filter_8h_aee038818cf7bbe044c3f7a7c86998c1b} indicated that the size of the Filter Properties field is zero, calling \doxyref{lzma\+\_\+properties\+\_\+encode()}{p.}{filter_8h_a8e00887086df5a44084ac22e48415de3} is not required, but it won\textquotesingle{}t do any harm either. 
\end{DoxyNote}


Referenced by lzma\+\_\+filter\+\_\+flags\+\_\+encode().

