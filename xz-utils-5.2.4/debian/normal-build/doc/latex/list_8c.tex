\section{xz/list.c File Reference}
\label{list_8c}\index{xz/list.\+c@{xz/list.\+c}}


Listing information about .xz files.  


{\ttfamily \#include \char`\"{}private.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tuklib\+\_\+integer.\+h\char`\"{}}\newline
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ xz\+\_\+file\+\_\+info}
\begin{DoxyCompactList}\small\item\em Information about a .xz file. \end{DoxyCompactList}\item 
struct \textbf{ block\+\_\+header\+\_\+info}
\begin{DoxyCompactList}\small\item\em Information about a .xz Block. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\label{list_8c_ad9d9d8c2f571536b8f85da8f0d2f9381}} 
\#define {\bfseries X\+Z\+\_\+\+F\+I\+L\+E\+\_\+\+I\+N\+F\+O\+\_\+\+I\+N\+IT}~\{ N\+U\+LL, 0, 0, true, 50000002 \}
\item 
\#define \textbf{ C\+H\+E\+C\+K\+S\+\_\+\+S\+T\+R\+\_\+\+S\+I\+ZE}~1024
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static const char $\ast$ \textbf{ xz\+\_\+ver\+\_\+to\+\_\+str} (uint32\+\_\+t ver)
\begin{DoxyCompactList}\small\item\em Convert XZ Utils version number to a string. \end{DoxyCompactList}\item 
static bool \textbf{ parse\+\_\+indexes} (\textbf{ xz\+\_\+file\+\_\+info} $\ast$xfi, \textbf{ file\+\_\+pair} $\ast$pair)
\begin{DoxyCompactList}\small\item\em Parse the Index(es) from the given .xz file. \end{DoxyCompactList}\item 
static bool \textbf{ parse\+\_\+block\+\_\+header} (\textbf{ file\+\_\+pair} $\ast$pair, const \textbf{ lzma\+\_\+index\+\_\+iter} $\ast$iter, \textbf{ block\+\_\+header\+\_\+info} $\ast$bhi, \textbf{ xz\+\_\+file\+\_\+info} $\ast$xfi)
\begin{DoxyCompactList}\small\item\em Parse the Block Header. \end{DoxyCompactList}\item 
static bool \textbf{ parse\+\_\+check\+\_\+value} (\textbf{ file\+\_\+pair} $\ast$pair, const \textbf{ lzma\+\_\+index\+\_\+iter} $\ast$iter)
\begin{DoxyCompactList}\small\item\em Parse the Check field and put it into check\+\_\+value[]. \end{DoxyCompactList}\item 
static bool \textbf{ parse\+\_\+details} (\textbf{ file\+\_\+pair} $\ast$pair, const \textbf{ lzma\+\_\+index\+\_\+iter} $\ast$iter, \textbf{ block\+\_\+header\+\_\+info} $\ast$bhi, \textbf{ xz\+\_\+file\+\_\+info} $\ast$xfi)
\begin{DoxyCompactList}\small\item\em Parse detailed information about a Block. \end{DoxyCompactList}\item 
static const char $\ast$ \textbf{ get\+\_\+ratio} (uint64\+\_\+t compressed\+\_\+size, uint64\+\_\+t uncompressed\+\_\+size)
\begin{DoxyCompactList}\small\item\em Get the compression ratio. \end{DoxyCompactList}\item 
static void \textbf{ get\+\_\+check\+\_\+names} (char buf[\textbf{ C\+H\+E\+C\+K\+S\+\_\+\+S\+T\+R\+\_\+\+S\+I\+ZE}], uint32\+\_\+t checks, bool space\+\_\+after\+\_\+comma)
\begin{DoxyCompactList}\small\item\em Get a comma-\/separated list of Check names. \end{DoxyCompactList}\item 
\mbox{\label{list_8c_ac7876d4d338f652c5bd3aa42494a2250}} 
static bool {\bfseries print\+\_\+info\+\_\+basic} (const \textbf{ xz\+\_\+file\+\_\+info} $\ast$xfi, \textbf{ file\+\_\+pair} $\ast$pair)
\item 
\mbox{\label{list_8c_a3cf5e9b274fd72124b29938c0280a38b}} 
static void {\bfseries print\+\_\+adv\+\_\+helper} (uint64\+\_\+t stream\+\_\+count, uint64\+\_\+t block\+\_\+count, uint64\+\_\+t compressed\+\_\+size, uint64\+\_\+t uncompressed\+\_\+size, uint32\+\_\+t checks, uint64\+\_\+t stream\+\_\+padding)
\item 
\mbox{\label{list_8c_a94d7f6e29b6da2dc3ef3c85c9e043fd6}} 
static bool {\bfseries print\+\_\+info\+\_\+adv} (\textbf{ xz\+\_\+file\+\_\+info} $\ast$xfi, \textbf{ file\+\_\+pair} $\ast$pair)
\item 
\mbox{\label{list_8c_a1be82234154dad0429454b94811aa1b5}} 
static bool {\bfseries print\+\_\+info\+\_\+robot} (\textbf{ xz\+\_\+file\+\_\+info} $\ast$xfi, \textbf{ file\+\_\+pair} $\ast$pair)
\item 
\mbox{\label{list_8c_a74dbce5976005821dbb5aedd6fba1a16}} 
static void {\bfseries update\+\_\+totals} (const \textbf{ xz\+\_\+file\+\_\+info} $\ast$xfi)
\item 
\mbox{\label{list_8c_ac20eb95fe3de6e849d752b4712de03b3}} 
static void {\bfseries print\+\_\+totals\+\_\+basic} (void)
\item 
\mbox{\label{list_8c_ae181b8b1d1222474d4417e36c13855eb}} 
static void {\bfseries print\+\_\+totals\+\_\+adv} (void)
\item 
\mbox{\label{list_8c_ac7df73c0aa9d21a248f5e32e400eae39}} 
static void {\bfseries print\+\_\+totals\+\_\+robot} (void)
\item 
void \textbf{ list\+\_\+totals} (void)
\begin{DoxyCompactList}\small\item\em Show the totals after all files have been listed. \end{DoxyCompactList}\item 
void \textbf{ list\+\_\+file} (const char $\ast$\textbf{ filename})
\begin{DoxyCompactList}\small\item\em List information about the given .xz file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const char \textbf{ check\+\_\+names} [\textbf{ L\+Z\+M\+A\+\_\+\+C\+H\+E\+C\+K\+\_\+\+I\+D\+\_\+\+M\+AX}+1][12]
\begin{DoxyCompactList}\small\item\em Check ID to string mapping. \end{DoxyCompactList}\item 
static char \textbf{ check\+\_\+value} [2 $\ast$\textbf{ L\+Z\+M\+A\+\_\+\+C\+H\+E\+C\+K\+\_\+\+S\+I\+Z\+E\+\_\+\+M\+AX}+1]
\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
struct \{\\
\>uint64\_t {\bfseries files}\\
\>uint64\_t {\bfseries streams}\\
\>uint64\_t {\bfseries blocks}\\
\>uint64\_t {\bfseries compressed\_size}\\
\>uint64\_t {\bfseries uncompressed\_size}\\
\>uint64\_t {\bfseries stream\_padding}\\
\>uint64\_t {\bfseries memusage\_max}\\
\>uint32\_t {\bfseries checks}\\
\>uint32\_t {\bfseries min\_version}\\
\>bool {\bfseries all\_have\_sizes}\\
\} \textbf{ totals} = \{ 0, 0, 0, 0, 0, 0, 0, 0, 50000002, true \}\\

\end{tabbing}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Listing information about .xz files. 



\subsection{Macro Definition Documentation}
\mbox{\label{list_8c_a3cf7cfcaed5e556420f15af7117f2d08}} 
\index{list.\+c@{list.\+c}!C\+H\+E\+C\+K\+S\+\_\+\+S\+T\+R\+\_\+\+S\+I\+ZE@{C\+H\+E\+C\+K\+S\+\_\+\+S\+T\+R\+\_\+\+S\+I\+ZE}}
\index{C\+H\+E\+C\+K\+S\+\_\+\+S\+T\+R\+\_\+\+S\+I\+ZE@{C\+H\+E\+C\+K\+S\+\_\+\+S\+T\+R\+\_\+\+S\+I\+ZE}!list.\+c@{list.\+c}}
\subsubsection{C\+H\+E\+C\+K\+S\+\_\+\+S\+T\+R\+\_\+\+S\+I\+ZE}
{\footnotesize\ttfamily \#define C\+H\+E\+C\+K\+S\+\_\+\+S\+T\+R\+\_\+\+S\+I\+ZE~1024}

Buffer size for \doxyref{get\+\_\+check\+\_\+names()}{p.}{list_8c_a90aab9f7b2077d1cbad85ec256faa436}. This may be a bit ridiculous, but at least it\textquotesingle{}s enough if some language needs many multibyte chars. 

\subsection{Function Documentation}
\mbox{\label{list_8c_a32fdf796cd8d4e429fde5d08028eef03}} 
\index{list.\+c@{list.\+c}!xz\+\_\+ver\+\_\+to\+\_\+str@{xz\+\_\+ver\+\_\+to\+\_\+str}}
\index{xz\+\_\+ver\+\_\+to\+\_\+str@{xz\+\_\+ver\+\_\+to\+\_\+str}!list.\+c@{list.\+c}}
\subsubsection{xz\+\_\+ver\+\_\+to\+\_\+str()}
{\footnotesize\ttfamily static const char$\ast$ xz\+\_\+ver\+\_\+to\+\_\+str (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{ver }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Convert XZ Utils version number to a string. 

\mbox{\label{list_8c_ada243f83a8540051b161d0a114ef8f24}} 
\index{list.\+c@{list.\+c}!parse\+\_\+indexes@{parse\+\_\+indexes}}
\index{parse\+\_\+indexes@{parse\+\_\+indexes}!list.\+c@{list.\+c}}
\subsubsection{parse\+\_\+indexes()}
{\footnotesize\ttfamily static bool parse\+\_\+indexes (\begin{DoxyParamCaption}\item[{\textbf{ xz\+\_\+file\+\_\+info} $\ast$}]{xfi,  }\item[{\textbf{ file\+\_\+pair} $\ast$}]{pair }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Parse the Index(es) from the given .xz file. 


\begin{DoxyParams}{Parameters}
{\em xfi} & Pointer to structure where the decoded information is stored. \\
\hline
{\em pair} & Input file\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
On success, false is returned. On error, true is returned. 
\end{DoxyReturn}


References message\+\_\+error(), and file\+\_\+pair\+::src\+\_\+st.

\mbox{\label{list_8c_ae8bf55be793e1ad58bc179ac19168c90}} 
\index{list.\+c@{list.\+c}!parse\+\_\+block\+\_\+header@{parse\+\_\+block\+\_\+header}}
\index{parse\+\_\+block\+\_\+header@{parse\+\_\+block\+\_\+header}!list.\+c@{list.\+c}}
\subsubsection{parse\+\_\+block\+\_\+header()}
{\footnotesize\ttfamily static bool parse\+\_\+block\+\_\+header (\begin{DoxyParamCaption}\item[{\textbf{ file\+\_\+pair} $\ast$}]{pair,  }\item[{const \textbf{ lzma\+\_\+index\+\_\+iter} $\ast$}]{iter,  }\item[{\textbf{ block\+\_\+header\+\_\+info} $\ast$}]{bhi,  }\item[{\textbf{ xz\+\_\+file\+\_\+info} $\ast$}]{xfi }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Parse the Block Header. 

The result is stored into $\ast$bhi. The caller takes care of initializing it.

\begin{DoxyReturn}{Returns}
False on success, true on error. 
\end{DoxyReturn}


Referenced by parse\+\_\+details().

\mbox{\label{list_8c_a9e7a2155d21e8e64be85e248e8a77f62}} 
\index{list.\+c@{list.\+c}!parse\+\_\+check\+\_\+value@{parse\+\_\+check\+\_\+value}}
\index{parse\+\_\+check\+\_\+value@{parse\+\_\+check\+\_\+value}!list.\+c@{list.\+c}}
\subsubsection{parse\+\_\+check\+\_\+value()}
{\footnotesize\ttfamily static bool parse\+\_\+check\+\_\+value (\begin{DoxyParamCaption}\item[{\textbf{ file\+\_\+pair} $\ast$}]{pair,  }\item[{const \textbf{ lzma\+\_\+index\+\_\+iter} $\ast$}]{iter }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Parse the Check field and put it into check\+\_\+value[]. 

\begin{DoxyReturn}{Returns}
False on success, true on error. 
\end{DoxyReturn}


References lzma\+\_\+stream\+\_\+flags\+::check, check\+\_\+value, lzma\+\_\+index\+\_\+iter\+::compressed\+\_\+file\+\_\+offset, lzma\+\_\+index\+\_\+iter\+::flags, io\+\_\+pread(), L\+Z\+M\+A\+\_\+\+C\+H\+E\+C\+K\+\_\+\+N\+O\+NE, lzma\+\_\+check\+\_\+size(), and lzma\+\_\+index\+\_\+iter\+::total\+\_\+size.



Referenced by parse\+\_\+details().

\mbox{\label{list_8c_a75d469c2b671db817dcca67130d89462}} 
\index{list.\+c@{list.\+c}!parse\+\_\+details@{parse\+\_\+details}}
\index{parse\+\_\+details@{parse\+\_\+details}!list.\+c@{list.\+c}}
\subsubsection{parse\+\_\+details()}
{\footnotesize\ttfamily static bool parse\+\_\+details (\begin{DoxyParamCaption}\item[{\textbf{ file\+\_\+pair} $\ast$}]{pair,  }\item[{const \textbf{ lzma\+\_\+index\+\_\+iter} $\ast$}]{iter,  }\item[{\textbf{ block\+\_\+header\+\_\+info} $\ast$}]{bhi,  }\item[{\textbf{ xz\+\_\+file\+\_\+info} $\ast$}]{xfi }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Parse detailed information about a Block. 

Since this requires seek(s), listing information about all Blocks can be slow.


\begin{DoxyParams}{Parameters}
{\em pair} & Input file \\
\hline
{\em iter} & Location of the Block whose Check value should be printed. \\
\hline
{\em bhi} & Pointer to structure where to store the information about the Block Header field.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
False on success, true on error. If an error occurs, the error message is printed too so the caller doesn\textquotesingle{}t need to worry about that. 
\end{DoxyReturn}


References parse\+\_\+block\+\_\+header(), and parse\+\_\+check\+\_\+value().

\mbox{\label{list_8c_ae914d2189f4e95281ba4fdfe363596fd}} 
\index{list.\+c@{list.\+c}!get\+\_\+ratio@{get\+\_\+ratio}}
\index{get\+\_\+ratio@{get\+\_\+ratio}!list.\+c@{list.\+c}}
\subsubsection{get\+\_\+ratio()}
{\footnotesize\ttfamily static const char$\ast$ get\+\_\+ratio (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{compressed\+\_\+size,  }\item[{uint64\+\_\+t}]{uncompressed\+\_\+size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Get the compression ratio. 

This has slightly different format than that is used in \doxyref{message.\+c}{p.}{message_8c}. \mbox{\label{list_8c_a90aab9f7b2077d1cbad85ec256faa436}} 
\index{list.\+c@{list.\+c}!get\+\_\+check\+\_\+names@{get\+\_\+check\+\_\+names}}
\index{get\+\_\+check\+\_\+names@{get\+\_\+check\+\_\+names}!list.\+c@{list.\+c}}
\subsubsection{get\+\_\+check\+\_\+names()}
{\footnotesize\ttfamily static void get\+\_\+check\+\_\+names (\begin{DoxyParamCaption}\item[{char}]{buf[\+C\+H\+E\+C\+K\+S\+\_\+\+S\+T\+R\+\_\+\+S\+I\+Z\+E],  }\item[{uint32\+\_\+t}]{checks,  }\item[{bool}]{space\+\_\+after\+\_\+comma }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Get a comma-\/separated list of Check names. 

The check names are translated with gettext except when in robot mode.


\begin{DoxyParams}{Parameters}
{\em buf} & Buffer to hold the resulting string \\
\hline
{\em checks} & Bit mask of Checks to print \\
\hline
{\em space\+\_\+after\+\_\+comma} & It\textquotesingle{}s better to not use spaces in table-\/like listings, but in more verbose formats a space after a comma is good for readability. \\
\hline
\end{DoxyParams}
\mbox{\label{list_8c_a569ef6a3578fb357c9c3246c2fe14607}} 
\index{list.\+c@{list.\+c}!list\+\_\+totals@{list\+\_\+totals}}
\index{list\+\_\+totals@{list\+\_\+totals}!list.\+c@{list.\+c}}
\subsubsection{list\+\_\+totals()}
{\footnotesize\ttfamily void list\+\_\+totals (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Show the totals after all files have been listed. 

\mbox{\label{list_8c_a2b9bdcc3cdcc48e99a29e178df9d4899}} 
\index{list.\+c@{list.\+c}!list\+\_\+file@{list\+\_\+file}}
\index{list\+\_\+file@{list\+\_\+file}!list.\+c@{list.\+c}}
\subsubsection{list\+\_\+file()}
{\footnotesize\ttfamily void list\+\_\+file (\begin{DoxyParamCaption}\item[{const char $\ast$}]{filename }\end{DoxyParamCaption})}



List information about the given .xz file. 



References opt\+\_\+format.



\subsection{Variable Documentation}
\mbox{\label{list_8c_a3e7ca9a7a1b4fae8eb5a64a197a34a71}} 
\index{list.\+c@{list.\+c}!check\+\_\+names@{check\+\_\+names}}
\index{check\+\_\+names@{check\+\_\+names}!list.\+c@{list.\+c}}
\subsubsection{check\+\_\+names}
{\footnotesize\ttfamily const char check\+\_\+names[\textbf{ L\+Z\+M\+A\+\_\+\+C\+H\+E\+C\+K\+\_\+\+I\+D\+\_\+\+M\+AX}+1][12]\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{
        
        
        
        N\_(\textcolor{stringliteral}{"None"}),
        \textcolor{stringliteral}{"CRC32"},
        
        
        
        
        
        N\_(\textcolor{stringliteral}{"Unknown-2"}),
        N\_(\textcolor{stringliteral}{"Unknown-3"}),
        \textcolor{stringliteral}{"CRC64"},
        N\_(\textcolor{stringliteral}{"Unknown-5"}),
        N\_(\textcolor{stringliteral}{"Unknown-6"}),
        N\_(\textcolor{stringliteral}{"Unknown-7"}),
        N\_(\textcolor{stringliteral}{"Unknown-8"}),
        N\_(\textcolor{stringliteral}{"Unknown-9"}),
        \textcolor{stringliteral}{"SHA-256"},
        N\_(\textcolor{stringliteral}{"Unknown-11"}),
        N\_(\textcolor{stringliteral}{"Unknown-12"}),
        N\_(\textcolor{stringliteral}{"Unknown-13"}),
        N\_(\textcolor{stringliteral}{"Unknown-14"}),
        N\_(\textcolor{stringliteral}{"Unknown-15"}),
\}
\end{DoxyCode}


Check ID to string mapping. 

\mbox{\label{list_8c_a49a34a8966827518afd5f95ce9899b5a}} 
\index{list.\+c@{list.\+c}!check\+\_\+value@{check\+\_\+value}}
\index{check\+\_\+value@{check\+\_\+value}!list.\+c@{list.\+c}}
\subsubsection{check\+\_\+value}
{\footnotesize\ttfamily char check\+\_\+value[2 $\ast$\textbf{ L\+Z\+M\+A\+\_\+\+C\+H\+E\+C\+K\+\_\+\+S\+I\+Z\+E\+\_\+\+M\+AX}+1]\hspace{0.3cm}{\ttfamily [static]}}

Value of the Check field as hexadecimal string. This is set by \doxyref{parse\+\_\+check\+\_\+value()}{p.}{list_8c_a9e7a2155d21e8e64be85e248e8a77f62}. 

Referenced by parse\+\_\+check\+\_\+value().

\mbox{\label{list_8c_ab2b4f01cb72e0fcad43f93d8eec68472}} 
\index{list.\+c@{list.\+c}!totals@{totals}}
\index{totals@{totals}!list.\+c@{list.\+c}}
\subsubsection{totals}
{\footnotesize\ttfamily struct \{ ... \}   totals\hspace{0.3cm}{\ttfamily [static]}}

Totals that are displayed if there was more than one file. The \char`\"{}files\char`\"{} counter is also used in print\+\_\+info\+\_\+adv() to show the file number. 