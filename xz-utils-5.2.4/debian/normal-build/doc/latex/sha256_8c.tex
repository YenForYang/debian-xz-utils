\section{liblzma/check/sha256.c File Reference}
\label{sha256_8c}\index{liblzma/check/sha256.\+c@{liblzma/check/sha256.\+c}}


S\+H\+A-\/256.  


{\ttfamily \#include \char`\"{}check.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\label{sha256_8c_a1a75de24d0277c5319098c218efaef2d}} 
\#define {\bfseries blk0}(i)~(W[i] = conv32be(data[i]))
\item 
\#define {\bfseries blk2}(i)
\item 
\mbox{\label{sha256_8c_ab0a0d1ad13c7e4d3cb38c89f7127c85a}} 
\#define {\bfseries Ch}(x,  y,  z)~(z $^\wedge$ (x \& (y $^\wedge$ z)))
\item 
\mbox{\label{sha256_8c_a447cd1d7fb703b62666400976be24bf3}} 
\#define {\bfseries Maj}(x,  y,  z)~((x \& (y $^\wedge$ z)) + (y \& z))
\item 
\mbox{\label{sha256_8c_aa9b8e98b3989bdffd7f36b281c72a693}} 
\#define {\bfseries a}(i)~T[(0 -\/ i) \& 7]
\item 
\mbox{\label{sha256_8c_a337ad8a7e52da2d584c2018f2ec2c81e}} 
\#define {\bfseries b}(i)~T[(1 -\/ i) \& 7]
\item 
\mbox{\label{sha256_8c_a63f410abde93141c9013b7d3f3971738}} 
\#define {\bfseries c}(i)~T[(2 -\/ i) \& 7]
\item 
\mbox{\label{sha256_8c_a23b5b0a85bf5762c93a855f40c0343ce}} 
\#define {\bfseries d}(i)~T[(3 -\/ i) \& 7]
\item 
\mbox{\label{sha256_8c_af62772e2f383ddbe93a93eff2a5f543a}} 
\#define {\bfseries e}(i)~T[(4 -\/ i) \& 7]
\item 
\mbox{\label{sha256_8c_a357394e0f6f88c8a57bd893ab28dc8f8}} 
\#define {\bfseries f}(i)~T[(5 -\/ i) \& 7]
\item 
\mbox{\label{sha256_8c_a9608045402267746965fa49d90bbada4}} 
\#define {\bfseries g}(i)~T[(6 -\/ i) \& 7]
\item 
\mbox{\label{sha256_8c_acf9942d15f0dd0ac4fc5ca66096a3f6d}} 
\#define {\bfseries h}(i)~T[(7 -\/ i) \& 7]
\item 
\#define {\bfseries R}(i,  j,  blk)
\item 
\mbox{\label{sha256_8c_a7e9a53a90caf3f2f7748239643054c0a}} 
\#define {\bfseries R0}(i)~R(i, 0, blk0(i))
\item 
\mbox{\label{sha256_8c_a8b464a331c111c6767cdc3c1af6c306b}} 
\#define {\bfseries R2}(i)~R(i, j, blk2(i))
\item 
\mbox{\label{sha256_8c_a4fe3c738087e923a3174ad2a116e3be5}} 
\#define {\bfseries S0}(x)~rotr\+\_\+32(x $^\wedge$ rotr\+\_\+32(x $^\wedge$ rotr\+\_\+32(x, 9), 11), 2)
\item 
\mbox{\label{sha256_8c_a59c41bcd16cbf3247d426429c3bf8e08}} 
\#define {\bfseries S1}(x)~rotr\+\_\+32(x $^\wedge$ rotr\+\_\+32(x $^\wedge$ rotr\+\_\+32(x, 14), 5), 6)
\item 
\mbox{\label{sha256_8c_aa4074fe219868f65efa393f656020fed}} 
\#define {\bfseries s0}(x)~(rotr\+\_\+32(x $^\wedge$ rotr\+\_\+32(x, 11), 7) $^\wedge$ (x $>$$>$ 3))
\item 
\mbox{\label{sha256_8c_ac1e4ed4e56436a432900cad5a1225731}} 
\#define {\bfseries s1}(x)~(rotr\+\_\+32(x $^\wedge$ rotr\+\_\+32(x, 2), 17) $^\wedge$ (x $>$$>$ 10))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\label{sha256_8c_a3d7c36c0c8994b20316859ddf2cd5b7b}} 
static uint32\+\_\+t {\bfseries rotr\+\_\+32} (uint32\+\_\+t num, unsigned amount)
\item 
\mbox{\label{sha256_8c_a14d774b070bce574a526fd138ae70dea}} 
static void {\bfseries transform} (uint32\+\_\+t state[8], const uint32\+\_\+t data[16])
\item 
\mbox{\label{sha256_8c_a1a3c107d249ff7adedee1b0d94557500}} 
static void {\bfseries process} (\textbf{ lzma\+\_\+check\+\_\+state} $\ast$\textbf{ check})
\item 
void \textbf{ lzma\+\_\+sha256\+\_\+init} (\textbf{ lzma\+\_\+check\+\_\+state} $\ast$\textbf{ check})
\begin{DoxyCompactList}\small\item\em Prepare S\+H\+A-\/256 state for new input. \end{DoxyCompactList}\item 
void \textbf{ lzma\+\_\+sha256\+\_\+update} (const uint8\+\_\+t $\ast$buf, size\+\_\+t size, \textbf{ lzma\+\_\+check\+\_\+state} $\ast$\textbf{ check})
\begin{DoxyCompactList}\small\item\em Update the S\+H\+A-\/256 hash state. \end{DoxyCompactList}\item 
void \textbf{ lzma\+\_\+sha256\+\_\+finish} (\textbf{ lzma\+\_\+check\+\_\+state} $\ast$\textbf{ check})
\begin{DoxyCompactList}\small\item\em Finish the S\+H\+A-\/256 calculation and store the result to check-\/$>$buffer.\+u8. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const uint32\+\_\+t {\bfseries S\+H\+A256\+\_\+K} [64]
\end{DoxyCompactItemize}


\subsection{Detailed Description}
S\+H\+A-\/256. 

\begin{DoxyRefDesc}{Todo}
\item[\textbf{ Todo}]Crypto++ has x86 A\+SM optimizations. They use S\+SE so if they are imported to liblzma, S\+SE instructions need to be used conditionally to keep the code working on older boxes. \end{DoxyRefDesc}


\subsection{Macro Definition Documentation}
\mbox{\label{sha256_8c_adbe8c231d3e02ee92deb523592868e5c}} 
\index{sha256.\+c@{sha256.\+c}!blk2@{blk2}}
\index{blk2@{blk2}!sha256.\+c@{sha256.\+c}}
\subsubsection{blk2}
{\footnotesize\ttfamily \#define blk2(\begin{DoxyParamCaption}\item[{}]{i }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
(W[i & 15] += s1(W[(i - 2) & 15]) + W[(i - 7) & 15] \(\backslash\)
                + s0(W[(i - 15) & 15]))
\end{DoxyCode}
\mbox{\label{sha256_8c_a9b4908a753357c13ea89daaeb9a8a946}} 
\index{sha256.\+c@{sha256.\+c}!R@{R}}
\index{R@{R}!sha256.\+c@{sha256.\+c}}
\subsubsection{R}
{\footnotesize\ttfamily \#define R(\begin{DoxyParamCaption}\item[{}]{i,  }\item[{}]{j,  }\item[{}]{blk }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
h(i) += S1(e(i)) + Ch(e(i), f(i), g(i)) + SHA256\_K[i + j] + blk; \(\backslash\)
        d(i) += h(i); \(\backslash\)
        h(i) += S0(a(i)) + Maj(a(i), b(i), c(i))
\end{DoxyCode}


\subsection{Function Documentation}
\mbox{\label{sha256_8c_a50600904325e18ab14051ee24bd3264b}} 
\index{sha256.\+c@{sha256.\+c}!lzma\+\_\+sha256\+\_\+init@{lzma\+\_\+sha256\+\_\+init}}
\index{lzma\+\_\+sha256\+\_\+init@{lzma\+\_\+sha256\+\_\+init}!sha256.\+c@{sha256.\+c}}
\subsubsection{lzma\+\_\+sha256\+\_\+init()}
{\footnotesize\ttfamily void lzma\+\_\+sha256\+\_\+init (\begin{DoxyParamCaption}\item[{\textbf{ lzma\+\_\+check\+\_\+state} $\ast$}]{check }\end{DoxyParamCaption})}



Prepare S\+H\+A-\/256 state for new input. 



References lzma\+\_\+sha256\+\_\+state\+::size, lzma\+\_\+sha256\+\_\+state\+::state, and lzma\+\_\+check\+\_\+state\+::state.



Referenced by lzma\+\_\+check\+\_\+init().

\mbox{\label{sha256_8c_a35110ebc966a6e20c018151ddb556e4a}} 
\index{sha256.\+c@{sha256.\+c}!lzma\+\_\+sha256\+\_\+update@{lzma\+\_\+sha256\+\_\+update}}
\index{lzma\+\_\+sha256\+\_\+update@{lzma\+\_\+sha256\+\_\+update}!sha256.\+c@{sha256.\+c}}
\subsubsection{lzma\+\_\+sha256\+\_\+update()}
{\footnotesize\ttfamily void lzma\+\_\+sha256\+\_\+update (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{buf,  }\item[{size\+\_\+t}]{size,  }\item[{\textbf{ lzma\+\_\+check\+\_\+state} $\ast$}]{check }\end{DoxyParamCaption})}



Update the S\+H\+A-\/256 hash state. 



References lzma\+\_\+check\+\_\+state\+::buffer, lzma\+\_\+sha256\+\_\+state\+::size, and lzma\+\_\+check\+\_\+state\+::state.



Referenced by lzma\+\_\+check\+\_\+update().

\mbox{\label{sha256_8c_aa53f5151949f03053bc08425e87a4df5}} 
\index{sha256.\+c@{sha256.\+c}!lzma\+\_\+sha256\+\_\+finish@{lzma\+\_\+sha256\+\_\+finish}}
\index{lzma\+\_\+sha256\+\_\+finish@{lzma\+\_\+sha256\+\_\+finish}!sha256.\+c@{sha256.\+c}}
\subsubsection{lzma\+\_\+sha256\+\_\+finish()}
{\footnotesize\ttfamily void lzma\+\_\+sha256\+\_\+finish (\begin{DoxyParamCaption}\item[{\textbf{ lzma\+\_\+check\+\_\+state} $\ast$}]{check }\end{DoxyParamCaption})}



Finish the S\+H\+A-\/256 calculation and store the result to check-\/$>$buffer.\+u8. 



References lzma\+\_\+check\+\_\+state\+::buffer, lzma\+\_\+sha256\+\_\+state\+::size, and lzma\+\_\+check\+\_\+state\+::state.



\subsection{Variable Documentation}
\mbox{\label{sha256_8c_ab8f3ad1f1c5d0564c306a6714b2e4d08}} 
\index{sha256.\+c@{sha256.\+c}!S\+H\+A256\+\_\+K@{S\+H\+A256\+\_\+K}}
\index{S\+H\+A256\+\_\+K@{S\+H\+A256\+\_\+K}!sha256.\+c@{sha256.\+c}}
\subsubsection{S\+H\+A256\+\_\+K}
{\footnotesize\ttfamily const uint32\+\_\+t S\+H\+A256\+\_\+K[64]\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{
        0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5,
        0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5,
        0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3,
        0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174,
        0xE49B69C1, 0xEFBE4786, 0x0FC19DC6, 0x240CA1CC,
        0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA,
        0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7,
        0xC6E00BF3, 0xD5A79147, 0x06CA6351, 0x14292967,
        0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13,
        0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85,
        0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3,
        0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070,
        0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5,
        0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3,
        0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208,
        0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2,
\}
\end{DoxyCode}
