<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XZ Utils: liblzma/common/stream_buffer_encoder.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XZ Utils
   &#160;<span id="projectnumber">5.2.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2e0898c272e1f0f93c8ef15f5da2a912.html">liblzma</a></li><li class="navelem"><a class="el" href="dir_db777975f8e21a5de5f283e04473bf67.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stream_buffer_encoder.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Single-call .xz Stream encoder.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;index.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ace1b0af8bcbc7079142ac2587b02615f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream__buffer__encoder_8c.html#ace1b0af8bcbc7079142ac2587b02615f">INDEX_BOUND</a>&#160;&#160;&#160;((1 + 1 + 2 * <a class="el" href="vli_8h.html#a063ecff4133aa2f8899b9fa3fdefd310">LZMA_VLI_BYTES_MAX</a> + 4 + 3) &amp; ~3)</td></tr>
<tr class="separator:ace1b0af8bcbc7079142ac2587b02615f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf3bc89aed406bb48c785dca58ae9da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream__buffer__encoder_8c.html#a6cf3bc89aed406bb48c785dca58ae9da">HEADERS_BOUND</a>&#160;&#160;&#160;(2 * <a class="el" href="stream__flags_8h.html#ada7e0a4f5e7146f547962cb9e9ef08ee">LZMA_STREAM_HEADER_SIZE</a> + <a class="el" href="stream__buffer__encoder_8c.html#ace1b0af8bcbc7079142ac2587b02615f">INDEX_BOUND</a>)</td></tr>
<tr class="memdesc:a6cf3bc89aed406bb48c785dca58ae9da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stream Header, Stream Footer, and Index.  <a href="#a6cf3bc89aed406bb48c785dca58ae9da">More...</a><br /></td></tr>
<tr class="separator:a6cf3bc89aed406bb48c785dca58ae9da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a870286986caa1c0ac6ce6c4074284420"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream__buffer__encoder_8c.html#a870286986caa1c0ac6ce6c4074284420">lzma_stream_buffer_bound</a> (size_t uncompressed_size)</td></tr>
<tr class="memdesc:a870286986caa1c0ac6ce6c4074284420"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate output buffer size for single-call Stream encoder.  <a href="#a870286986caa1c0ac6ce6c4074284420">More...</a><br /></td></tr>
<tr class="separator:a870286986caa1c0ac6ce6c4074284420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67f2d3ab78626a8a52c64e207a433d0c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8h.html#a8494e0457e1463d6d2b6836018d87b6e">lzma_ret</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream__buffer__encoder_8c.html#a67f2d3ab78626a8a52c64e207a433d0c">lzma_stream_buffer_encode</a> (<a class="el" href="structlzma__filter.html">lzma_filter</a> *<a class="el" href="coder_8c.html#a9325236d5759d4eaadcba08a6bb5c96f">filters</a>, <a class="el" href="api_2lzma_2check_8h.html#a0a6100c719ac9aa49be3fdf7519e8c3f">lzma_check</a> <a class="el" href="coder_8c.html#a5c94b0defea7996f245faec2693056cb">check</a>, const <a class="el" href="structlzma__allocator.html">lzma_allocator</a> *allocator, const uint8_t *in, size_t in_size, uint8_t *out, size_t *out_pos_ptr, size_t out_size)</td></tr>
<tr class="memdesc:a67f2d3ab78626a8a52c64e207a433d0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single-call .xz Stream encoder.  <a href="#a67f2d3ab78626a8a52c64e207a433d0c">More...</a><br /></td></tr>
<tr class="separator:a67f2d3ab78626a8a52c64e207a433d0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Single-call .xz Stream encoder. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ace1b0af8bcbc7079142ac2587b02615f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace1b0af8bcbc7079142ac2587b02615f">&#9670;&nbsp;</a></span>INDEX_BOUND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INDEX_BOUND&#160;&#160;&#160;((1 + 1 + 2 * <a class="el" href="vli_8h.html#a063ecff4133aa2f8899b9fa3fdefd310">LZMA_VLI_BYTES_MAX</a> + 4 + 3) &amp; ~3)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum size of Index that has exactly one Record. Index Indicator + Number of Records + Record + CRC32 rounded up to the next multiple of four. </p>

</div>
</div>
<a id="a6cf3bc89aed406bb48c785dca58ae9da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf3bc89aed406bb48c785dca58ae9da">&#9670;&nbsp;</a></span>HEADERS_BOUND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HEADERS_BOUND&#160;&#160;&#160;(2 * <a class="el" href="stream__flags_8h.html#ada7e0a4f5e7146f547962cb9e9ef08ee">LZMA_STREAM_HEADER_SIZE</a> + <a class="el" href="stream__buffer__encoder_8c.html#ace1b0af8bcbc7079142ac2587b02615f">INDEX_BOUND</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stream Header, Stream Footer, and Index. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a870286986caa1c0ac6ce6c4074284420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a870286986caa1c0ac6ce6c4074284420">&#9670;&nbsp;</a></span>lzma_stream_buffer_bound()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t lzma_stream_buffer_bound </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>uncompressed_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate output buffer size for single-call Stream encoder. </p>
<p>When trying to compress uncompressible data, the encoded size will be slightly bigger than the input data. This function calculates how much output buffer space is required to be sure that <a class="el" href="container_8h.html#a6e645ccaeace3b13a6981e03c6e190ad" title="Single-call .xz Stream encoder. ">lzma_stream_buffer_encode()</a> doesn't return LZMA_BUF_ERROR.</p>
<p>The calculated value is not exact, but it is guaranteed to be big enough. The actual maximum output space required may be slightly smaller (up to about 100 bytes). This should not be a problem in practice.</p>
<p>If the calculated maximum size doesn't fit into size_t or would make the Stream grow past LZMA_VLI_MAX (which should never happen in practice), zero is returned to indicate the error.</p>
<dl class="section note"><dt>Note</dt><dd>The limit calculated by this function applies only to single-call encoding. Multi-call encoding may (and probably will) have larger maximum expansion when encoding uncompressible data. Currently there is no function to calculate the maximum expansion of multi-call encoding. </dd></dl>

</div>
</div>
<a id="a67f2d3ab78626a8a52c64e207a433d0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67f2d3ab78626a8a52c64e207a433d0c">&#9670;&nbsp;</a></span>lzma_stream_buffer_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8h.html#a8494e0457e1463d6d2b6836018d87b6e">lzma_ret</a> lzma_stream_buffer_encode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlzma__filter.html">lzma_filter</a> *&#160;</td>
          <td class="paramname"><em>filters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="api_2lzma_2check_8h.html#a0a6100c719ac9aa49be3fdf7519e8c3f">lzma_check</a>&#160;</td>
          <td class="paramname"><em>check</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structlzma__allocator.html">lzma_allocator</a> *&#160;</td>
          <td class="paramname"><em>allocator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>in_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>out_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>out_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single-call .xz Stream encoder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filters</td><td>Array of filters. This must be terminated with filters[n].id = LZMA_VLI_UNKNOWN. See <a class="el" href="filter_8h.html" title="Common filter related types and functions. ">filter.h</a> for more information. </td></tr>
    <tr><td class="paramname">check</td><td>Type of the integrity check to calculate from uncompressed data. </td></tr>
    <tr><td class="paramname">allocator</td><td><a class="el" href="structlzma__allocator.html" title="Custom functions for memory handling. ">lzma_allocator</a> for custom allocator functions. Set to NULL to use malloc() and free(). </td></tr>
    <tr><td class="paramname">in</td><td>Beginning of the input buffer </td></tr>
    <tr><td class="paramname">in_size</td><td>Size of the input buffer </td></tr>
    <tr><td class="paramname">out</td><td>Beginning of the output buffer </td></tr>
    <tr><td class="paramname">out_pos</td><td>The next byte will be written to out[*out_pos]. *out_pos is updated only if encoding succeeds. </td></tr>
    <tr><td class="paramname">out_size</td><td>Size of the out buffer; the first byte into which no data is written to is out[out_size].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- LZMA_OK: Encoding was successful.<ul>
<li>LZMA_BUF_ERROR: Not enough output buffer space.</li>
<li>LZMA_UNSUPPORTED_CHECK</li>
<li>LZMA_OPTIONS_ERROR</li>
<li>LZMA_MEM_ERROR</li>
<li>LZMA_DATA_ERROR</li>
<li>LZMA_PROG_ERROR </li>
</ul>
</dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
